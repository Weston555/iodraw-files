```mermaid
flowchart TD
    A-->[Data Loading & Preprocessing<br/>- Load CSV files & LSTM predictions]
    B-->[Portfolio Optimization<br/>Expected Return: Rₚ = Σ(w * μ)<br/>Volatility: σₚ = √(wᵀ · Cov · w)<br/>Sharpe Ratio: S = (Rₚ - rf) / σₚ]
    C-->[Portfolio Selection<br/>- Select portfolio type<br/>- Filter stocks by weight threshold]
    D-->[Trading Environment Setup<br/>- Build multi-factor state (returns, RSI, volatility, predictions, trends)<br/>- Set initial portfolio weights]
    E[PPO Training & Trading Simulation<br/>- Train PPO algorithm<br/>- Record transaction logs]
    F[Evaluation & Visualization<br/>- Calculate performance metrics<br/>- Plot cumulative returns & annotate weights]
    G[Save & Export Results<br/>- Save CSV logs, TXT summaries, and image outputs]

    A --> B
    B --> C
    C --> D
    D --> E
    E --> F
    F --> G

```